"use strict";(function(){const CFG=(document.querySelector('meta[name=appbase-i18n]')?.content||'').split(';').reduce((a,p)=>{const[k,v]=p.trim().split('=');if(k) a[k]=v;return a;},{defaultLocale:'pt-BR',supportedLocales:'pt-BR,en-US'});const LS='app.locale';const SUP=(CFG.supportedLocales||'pt-BR').split(',');const loc0=localStorage.getItem(LS)||CFG.defaultLocale||'pt-BR';function apply(dict){document.querySelectorAll('[data-i18n]').forEach(el=>{const key=el.getAttribute('data-i18n');const val=key.split('.').reduce((o,k)=>o&&o[k],dict);if(typeof val==='string') el.textContent=val;});}async function load(loc){if(!SUP.includes(loc)) return;try{const res=await fetch(`appbase/i18n/${loc}.json`);const dict=await res.json();apply(dict);window.dispatchEvent(new CustomEvent('app:i18n:locale_changed',{detail:{locale:loc}}));localStorage.setItem(LS,loc);}catch(e){console.warn('[i18n] load failed',e);}}window.AppBaseI18n={setLocale:load,getLocale:()=>localStorage.getItem(LS)||loc0,supported:SUP};load(loc0);})();
